# 并查集（Disjoint-set data structure）

首先从名称上来说，并查集的意思就是 合并（Union）和查询（Find）

- 合并（Union）：合并两个元素所属集合（合并对应的树）
- 查询（Find）：查询某个元素所属集合（查询对应的树的根节点），这可以用于判断两个元素是否属于同一集合

优化

1. 路径压缩
2. 按秩合并，将简单的树往复杂的树上合并

应用场景

- 图的连通性问题（如 Kruskal 最小生成树算法）。
- 动态网络连接检测（如社交网络好友关系）。
- 像素聚类（图像处理中的区域合并）。

## 11-连续出牌数量

### 题目描述

有这么一款单人卡牌游戏，牌面由颜色和数字组成，颜色为红、黄、蓝、緣中的一种，数字为 0-9 中的一个。游戏开始时玩家从手牌中选取一张卡牌打出，接下来如果玩家手中有和他上一次打出的手牌颜色或者数字相同的手牌，他可以继续将该手牌打出，直至手牌打光或者
没有符合条件可以继续打出的手牌。
现给定一副手牌，请找到最优的出牌策略，使打出的手牌最家。

### 输入描述

输入为两行

- 第一行是每张手牌的数字，数字由空格分隔，
- 第二行为对应的每张手牌的额色，用 ry bg 这 4 个字母分别代表 4 种颜色，字母也由空格分隔。
- 手牌数量不超过 10。

### 输出描述

输出一个数字，即最多能打出的手牌的数量。

### 用例

![2-11-连续出牌数量-用例](./images/2-11-连续出牌数量-用例.png)

### 分析

如图，题目意思可以理解为要求{num, color}顶点的联通关系，相同 num 或者相同 color 的顶点可以联通。也就是两个元素只要满足其中一个联通条件，就可以放到一个集合中。然后找到元素数量最多的集合，这个数量就是答案。

![2-11-并查集](./images/2-11-并查集.png)

并查集就是用来解决元素分组的问题。

1. 先按照"相同 num 或者相同 color "的规则，以 nums 和 colors 为原始数据，构造并查集。
2. 再统计集合中元素数量，找到最大数量的。

### 代码分析

代码：exercise/level-2/11.连续出牌数量-答案.js

1. 按照规则构造并查集 ufs，执行`ufs.union(i, j);`，最后就形成了两个集合。过程解析：

   数据：
   nums [1, 4, 3, 4, 5]
   colors ["r", "y", "b", "b", "r"]

   并查集初始化，每个位置的值就是存储索引
   ufs [0, 1, 2, 3, 4]

   执行`ufs.union(i, j);`过程：

   索引 0 和 4 的元素满足花色相同 放到一个集合，要访问 4，通过 0 代理，将 4 位置改成 0
   ufs [0, 1, 2, 3, 0]

   索引 1 和 3 的元素满足数字相同 放到一个集合，要访问 3，通过 1 代理，将 3 位置改成 1
   ufs [0, 1, 2, 1, 0]

   索引 2 和 3 的元素满足数字相同 放到一个集合，要访问 3，通过 2 代理
   由于上一步访问 3，通过 1 代理，所以是拿 1 位置上的数字，将 1 位置变成了 2 位置的数字
   ufs [0, 2, 2, 1, 0]

   也就是，0 和 4 元素在一个集合中，访问 4 位置元素时，4 位置存放的它代理 4 元素的父级 0 元素的索引，通过该索引可以拿到 0 的索引。
   1、2、3 元素在一个集合中，3 的父级为 1，1 的父级为 2，2 就是指向自己，每个位置存储的是自己父级的索引。

2. 再遍历，找到在一个集合中的元素。对象 count，键为代表集合根级的索引，值记录集合中有多少个元素，最后取出最大的那个。
   count {0: 2, 2: 3}

## 52-图像物体的边界

1. 如何将题目转化为 求解像素 5 之间是否联通
2. 并查集的写法思路

## [Kruskal 最小生成树算法](https://www.bilibili.com/video/BV1MiGdzJEck/?vd_source=1e7b376e808b1c65c1698e6665a195bf)

例题：城市之间铺设电缆，不同城市之间铺设电缆的成本是不同的，需要连通所有城市，并最小化电缆成本。

关键点：

1. 连接所有城市的路径不能形成环，有环表示存在冗余路径
2. n 个节点最小需要连接 n-1 条边

思路：

1. 按照边的权重从小到大排序
2. 依次尝试加入边，如果加入后不形成环，则加入，否则跳过
3. 重复步骤 2，直到找到 n-1 条边

第二步使用并查集
加入后是否形成环，判断是否在一个集合中，如果不在，说明没有形成环，这时候可以 union 加入边

## 资料：

- [算法学习笔记(1) : 并查集](https://zhuanlan.zhihu.com/p/93647900)
- [并查集](https://oi-wiki.org/ds/dsu/)
